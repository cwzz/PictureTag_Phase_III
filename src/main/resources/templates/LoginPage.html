<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Creative - Bootstrap 3 Responsive Admin Template">
    <meta name="author" content="GeeksLabs">
    <meta name="keyword" content="Creative, Dashboard, Admin, Template, Theme, Bootstrap, Responsive, Retina, Minimal">

    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>

    <title>众包标注平台登录</title>
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/bootstrap-theme.min.css" type="text/css" media="all">
    <link href="/css/styles.css" rel="stylesheet">
    <link href="/css/queries.css" rel="stylesheet">
    <link href="/css/animate.css" rel="stylesheet">
    <link href="/css/font-awesome.css" rel="stylesheet">
    <link href="/css/carousel.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/default.css" type="text/css" media="all">
    <link rel="stylesheet" href="/css/css.css" type="text/css" media="all">
    <link rel="stylesheet" href="/css/pop-up-box" type="text/css" media="all">
    <link rel="stylesheet" type='text/css' href="/css/log.css">
    <link rel="stylesheet" type="text/css" href="/css/input-invalid.css">
    <link rel="stylesheet" type="text/css" href="/css/jquery-confirm.css" />

    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <script src="/js/modernizr.min.js"></script>
    <script src="/js/jquery.js"></script>
    <script src="/js/jquery.easing.1.3.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/classie.js"></script>
    <script type="text/javascript" src="/js/jquery-confirm.js"></script>


</head>

<body id="sign-in-body">

<div class="navbar skrollable skrollable-between" role="navigation"
     style="line-height:60px; height:60px; background-color:rgba(255, 255, 255, 0.8);">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="fa fa-bars color-white"></span>
            </button>
            <p style="font-size:2em;margin: 0.67em 0;color: #353535">众包标注平台<a class="navbar-brand skrollable skrollable-between" href="<%=basePath%>"
                         style="display:none;margin-top:5px;"></a>
            </p>
        </div>

            <ul class="menu nav navbar-nav skrollable skrollable-between nnav"
                style="margin-top:5px;display:inline;" >
                <li><a href="/cwzz/introduce">首页</a>
                    <ul class="submenu">
                        <li><a href="/introduce">网站介绍</a></li>
                        <!--<li><a href="<%=basePath%>/market/market">大盘概览</a></li>-->
                    </ul>
                </li>
                <li><a href="/cwzz/home">项目</a>
                    <ul class="submenu">
                        <li><a href="/cwzz/home">项目大厅</a></li>
                        <li><a href="/cwzz/upload">发布项目</a></li>
                    </ul>
                </li>
                <li><a href="/cwzz/personal_center">个人</a>
                    <ul class="submenu">
                        <li><a href="/cwzz/personal_center">个人信息</a></li>
                        <li><a href="/cwzz/personal_center">任务详情</a></li>
                    </ul>
                </li>
                <li><a href="<%=basePath%>/help">帮助</a>
                    <ul class="submenu">
                        <li><a href="<%=basePath%>/help">详情咨询</a></li>
                        <li><a href="<%=basePath%>/aboutus">关于我们</a></li>
                    </ul>
                </li>
                <li>
                    <a href="/cwzz/login">登录</a>
                    <ul class="submenu">
                        <li><a href="/cwzz/register">注册</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</div>

<div class="sign-in-container" >
    <div class="send-form form-center">

        <section class="sign-content bgcolor-1">
            <!--<h1 class="nomargin-bottom sign-logo"><img src='../../img/logo1.png' width="380" alt="DearQuant"></a>-->
            <!--</h1>-->
            <br>
            <h1 class="nomargin-bottom">
                <span id="log-note">欢迎使用<br>登入众包标注平台</span>
            </h1>
            <br>
            <span class="input input--hoshi">
                <input class="input__field input__field--hoshi" type="text" id="input-1" pattern="[a-z]{1,15}" title="1到15位字母" name="username"/>
                <label class="input__label input__label--hoshi input__label--hoshi-color-1" for="input-1">
                    <span class="input__label-content input__label-content--hoshi">用户名</span>
                </label>
            </span>
            <br>
            <span class="input input--hoshi">
                <input class="input__field input__field--hoshi" type="password" id="input-2" pattern="[a-z]{1,15}" required title="1到15位字母" name="password"/>
                <label class="input__label input__label--hoshi input__label--hoshi-color-2" for="input-2">
                    <span class="input__label-content input__label-content--hoshi">密码</span>
                </label>
            </span>

        </section>

        <section class="button-content">
            <div class="box bg-2">
                <button id="submit-btn" type="button"  class="button button--winona button--border-thick button--round-l button--text-upper button--size-m button--text-medium" data-text="登录"><span>登录</span></button>
            </div>
        </section>

        <br>
        <div id="changeLog">没有账户？<a href="/cwzz/register">前往注册</a></div>
    </div>
</div>

<footer>
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <ul class="legals">
                    <li>@Copyright NJUcwzz</li>
                    <!--<li><a href="#">Legals</a></li>-->
                </ul>
            </div>
            <div class="col-md-6 credit">
                <p>Designed &amp; Developed by <a href="http://www.peterfinlan.com/">NJUcwzz</a></a></p>
            </div>
        </div>
    </div>
</footer>

</body>

<script src="/js/classie.js"></script>

<script>
    (function() {
        // trim polyfill : https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/Trim
        if (!String.prototype.trim) {
            (function() {
                // Make sure we trim BOM and NBSP
                var rtrim = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;
                String.prototype.trim = function() {
                    return this.replace(rtrim, '');
                };
            })();
        }

        [].slice.call( document.querySelectorAll( 'input.input__field' ) ).forEach( function( inputEl ) {
            // in case the input is already filled..
            if( inputEl.value.trim() !== '' ) {
                classie.add( inputEl.parentNode, 'input--filled' );
            }

            // events:
            inputEl.addEventListener( 'focus', onInputFocus );
            inputEl.addEventListener( 'blur', onInputBlur );
        } );

        function onInputFocus( ev ) {
            classie.add( ev.target.parentNode, 'input--filled' );
        }

        function onInputBlur( ev ) {
            if( ev.target.value.trim() === '' ) {
                classie.remove( ev.target.parentNode, 'input--filled' );
            }
        }
    })();
</script>
<script>
    $(document).ready(function () {
        $("#submit-btn").click(function () {
            var u={username:$("#input-1").val(),password:$("#input-2").val()};

                $.ajax({
                    type : 'POST',
                    url : '/user/login',
                    contentType:"application/json",
                    dataType:"json",
                    data :JSON.stringify(u),
                    success : function (data) {
                        if(data=='CommonUserLogin') {
                            $.alert({
                                title: '登录成功！',
                                content: '登录成功 <br> 尽情访问众包标注系统吧',
                                confirmButton: '转去项目大厅',
                                confirmButtonClass: 'btn-primary',
                                icon: 'fa fa-info',
                                animation: 'rotate',
                                closeAnimation: 'right',
                                opacity: 0.5,
                                confirm: function () {
                                    window.location.href="/cwzz/home"
                                    localStorage.setItem("current_user",JSON.stringify(u));
                                }
                            });
                        }else if(data=='NOUSER'){
                            addTip(document.getElementById("input-1"),"用户名不存在","input-invalid-info-log log-animation");
                        }else if(data=="PASSERROR"){
                            addTip(document.getElementById("input-2"),"密码错误","input-invalid-info-log log-animation");
                        }
                        else if(data=='AdministratorLogin'){
                            $.alert({
                                title: '欢迎您，众包标注系统管理员！',
                                content: '欢迎回来  <br> 管理众包标注系统',
                                confirmButton: '转去管理员系统',
                                confirmButtonClass: 'btn-primary',
                                icon: 'fa fa-info',
                                animation: 'rotate',
                                closeAnimation: 'right',
                                opacity: 0.5,
                                confirm: function () {
                                    window.location.href="/cwzz/manager"
                                    localStorage.setItem("current_user",JSON.stringify(u));
                                }
                            });
                        }
                    },
                    error: function (data) {
                        // alert(data);
                        // alert("cuole")
                        // var pop_info="<div class='pop-page'>"+"密码错误"+"</div>"
                        // $(pop_info).one('animationend webkitAnimationEnd', function () {
                        //     $(this).remove();
                        // });
                        // $("body").append(pop_info);
                        $.alert({
                            title: '登录失败！',
                            content: '因为某些原因登录失败 <br> 请您重新登录',
                            confirmButton: '我知道了',
                            confirmButtonClass: 'btn-primary',
                            icon: 'fa fa-info',
                            animation: 'rotate',
                            closeAnimation: 'right',
                            opacity: 0.5,
                        });
                    }
                })
            }
        );
    });

    function addTip(obj,str,animationname) {
        var body=document.body;
        var infodiv=document.createElement('div');
        infodiv.className=animationname;
        infodiv.innerHTML=str;
        var x = obj.offsetLeft;
        var y = obj.offsetTop;
        while (obj = obj.offsetParent) {
            x += obj.offsetLeft;
            y += obj.offsetTop;
        }
        y+=30;
        infodiv.style.cssText="left:"+x+"px;top:"+y+"px;";
        $(infodiv).one('animationend webkitAnimationEnd', function () {
            $(this).remove();
        });
        body.appendChild(infodiv);
        return
    }

</script>

</html>